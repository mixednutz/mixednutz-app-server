<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity4">

  <body>
  
  	<div th:fragment="newJournalForm_model">
		<div class="modal-header">
			<button type="button" class="close" data-dismiss="modal"><span>&times;</span></button>
			<h4>New Journal</h4>
		</div>
		<form id="newjournal_form" th:action="@{|/journal/new|}" th:object="${newpost}" method="post">
		<div class="modal-body">
			<div class="row">
				<div class="journal-form col-xs-12 col-md-8">
					<div class="form-group">
						<label for="newjournal_subject">Title</label>
						<input id="newjournal_subject" class="form-control generatesTitleKey" type='text' th:field="*{subject}" size='50' required="required"/>
					</div>
					<div class="form-group">
						<label for="newjournal_subjectey">Uri</label>
						<div class="input-group input-group-sm">
							<span class="input-group-addon">
								<span th:with="now=${#dates.createNow()}">/<span class="owner" 
									th:text="${newpost.owner!=null?newpost.owner.username:#authentication.principal.username}">owner</span>/<span  
									th:text="${#dates.year(now)}" class="year">2004</span>/<span 
									th:text="${#dates.month(now)}" class="month">1</span>/<span 
									th:text="${#dates.day(now)}" class="day">1</span>/</span>
							</span>
							<input id="newjournal_subjectKey" class="form-control generatedTitleKey" type='text' th:field="*{subjectKey}" size='50' required="required"/>
						</div>
					</div>
					<div class="form-group">
						<label for="body">Body</label>
						<div class="btn-toolbar" data-role="editor-toolbar"
						        data-target="#editor">
						  	<div class="btn-group">
								<a class="btn btn-default" data-edit="bold" title="Bold (Ctrl/Cmd+B)"><i class="fas fa-bold"></i></a>
								<a class="btn btn-default" data-edit="italic" title="Italic (Ctrl/Cmd+I)"><i class="fas fa-italic"></i></a>
								<a class="btn btn-default" data-edit="strikethrough" title="Strikethrough"><i class="fas fa-strikethrough"></i></a>
								<a class="btn btn-default" data-edit="underline" title="Underline (Ctrl/Cmd+U)"><i class="fas fa-underline"></i></a>
							</div>
							<div class="btn-group">
								<a class="btn btn-default" data-edit="insertunorderedlist" title="Bullet list"><i class="fas fa-list-ul"></i></a>
								<a class="btn btn-default" data-edit="insertorderedlist" title="Number list"><i class="fas fa-list-ol"></i></a>
								<a class="btn btn-default" data-edit="outdent" title="Reduce indent (Shift+Tab)"><i class="fas fa-outdent"></i></a>
								<a class="btn btn-default" data-edit="indent" title="Indent (Tab)"><i class="fas fa-indent"></i></a>
							</div>
							<div class="btn-group">
								<a class="btn btn-default" data-edit="justifyleft" title="Align Left (Ctrl/Cmd+L)"><i class="fas fa-align-left"></i></a>
								<a class="btn btn-default" data-edit="justifycenter" title="Center (Ctrl/Cmd+E)"><i class="fas fa-align-center"></i></a>
								<a class="btn btn-default" data-edit="justifyright" title="Align Right (Ctrl/Cmd+R)"><i class="fas fa-align-right"></i></a>
								<a class="btn btn-default" data-edit="justifyfull" title="Justify (Ctrl/Cmd+J)"><i class="fas fa-align-justify"></i></a>
							</div>
							<div class="btn-group">
								<a class="btn btn-default dropdown-toggle" data-toggle="dropdown" title="Hyperlink"><i class="fas fa-link"></i></a>
								<div class="dropdown-menu input-append">
									<input placeholder="URL" type="text" data-edit="createLink" />
									<button class="btn" type="button">Add</button>
								</div>
							</div>
							<div class="btn-group">
								<a class="btn btn-default" data-edit="undo" title="Undo (Ctrl/Cmd+Z)"><i class="fas fa-undo"></i></a>
								<a class="btn btn-default" data-edit="redo" title="Redo (Ctrl/Cmd+Y)"><i class="fas fa-repeat"></i></a>
								<a class="btn btn-default" data-edit="html" title="Clear Formatting"><i class='glyphicon glyphicon-pencil'></i></a>
							</div>
						</div> 
						<input type="hidden" id="journal_body" th:field="*{body}"/>
						<div id="editor" class="form-control" data-placeholder="Start your journal..."></div>
					</div>
					<div class="form-group">
						<label for="summary">Summary</label>
						<input id="newjournal_summary" class="form-control" th:field="*{description}" size="50" type="text" placeholder="Short summary of your journal..."/>
					</div>
				</div>
				<div class="journal-options col-xs-12 col-md-4" th:include="common/fragments_forms :: post_options (${newpost}, ${ {'Journal':journalCrosspostFeeds} }, true, true, true, false)">
					journal-options
				</div>
			</div>
		</div>
		<div class="modal-footer">
			<button id="journal-submit-btn" type="submit" name="submit" value="Post Now">Post Now</button>
  			
			<button class="btn btn-success" type="button" name="submit" value="Post Now"
				onclick="$('#journal_body').val($('#editor').cleanHtml(true));$('#journal-submit-btn').click();">Post Now</button>
  			<button class="btn" type="button" data-dismiss="modal">Cancel</button>
		</div>
		</form>
		
	</div>
	<script th:fragment="newJournalForm_JS" >
	$('#editor').wysiwyg();
	$('#submit-btn').hide();
	</script>
	
	
	<div th:fragment="editJournalForm_model">
		<div class="modal-header">
			<button type="button" class="close" data-dismiss="modal"><span>&times;</span></button>
			<h4>Edit Journal</h4>
		</div>
		<form id="editjournal_form" th:action="@{|/journal/id/${journal.id}/edit|}" th:object="${journal}" method="post">
		<div class="modal-body">
			<div class="row">
				<div class="journal-form col-xs-12 col-md-8">
					<div class="form-group">
						<label for="editjournal_subject">Title</label>
						<input for="editjournal_subject" class="form-control generatesTitleKey" type='text' th:field="*{subject}" size='50' required="required"/>
					</div>
					<div class="form-group">
						<label for="editjournal_subjectey">Uri</label>
						<div class="input-group input-group-sm">
							<span class="input-group-addon">
								<span th:with="now=${#dates.createNow()}">/<span class="owner" 
									th:text="${journal.owner!=null?journal.owner.username:#authentication.principal.username}">owner</span>/<span  
									th:text="${#dates.year(now)}" class="year">2004</span>/<span 
									th:text="${#dates.month(now)}" class="month">1</span>/<span 
									th:text="${#dates.day(now)}" class="day">1</span>/</span>
							</span>
							<input id="editjournal_subjectKey" class="form-control generatedTitleKey" type='text' th:field="*{subjectKey}" size='50' required="required"/>
						</div>
					</div>
					
					<div class="form-group">
						<label for="body">Body</label>
						<div class="btn-toolbar" data-role="editor-toolbar"
						        data-target="#editor">
						  	<div class="btn-group">
								<a class="btn btn-default" data-edit="bold" title="Bold (Ctrl/Cmd+B)"><i class="fas fa-bold"></i></a>
								<a class="btn btn-default" data-edit="italic" title="Italic (Ctrl/Cmd+I)"><i class="fas fa-italic"></i></a>
								<a class="btn btn-default" data-edit="strikethrough" title="Strikethrough"><i class="fas fa-strikethrough"></i></a>
								<a class="btn btn-default" data-edit="underline" title="Underline (Ctrl/Cmd+U)"><i class="fas fa-underline"></i></a>
							</div>
							<div class="btn-group">
								<a class="btn btn-default" data-edit="insertunorderedlist" title="Bullet list"><i class="fas fa-list-ul"></i></a>
								<a class="btn btn-default" data-edit="insertorderedlist" title="Number list"><i class="fas fa-list-ol"></i></a>
								<a class="btn btn-default" data-edit="outdent" title="Reduce indent (Shift+Tab)"><i class="fas fa-outdent"></i></a>
								<a class="btn btn-default" data-edit="indent" title="Indent (Tab)"><i class="fas fa-indent"></i></a>
							</div>
							<div class="btn-group">
								<a class="btn btn-default" data-edit="justifyleft" title="Align Left (Ctrl/Cmd+L)"><i class="fas fa-align-left"></i></a>
								<a class="btn btn-default" data-edit="justifycenter" title="Center (Ctrl/Cmd+E)"><i class="fas fa-align-center"></i></a>
								<a class="btn btn-default" data-edit="justifyright" title="Align Right (Ctrl/Cmd+R)"><i class="fas fa-align-right"></i></a>
								<a class="btn btn-default" data-edit="justifyfull" title="Justify (Ctrl/Cmd+J)"><i class="fas fa-align-justify"></i></a>
							</div>
							<div class="btn-group">
								<a class="btn btn-default dropdown-toggle" data-toggle="dropdown" title="Hyperlink"><i class="fas fa-link"></i></a>
								<div class="dropdown-menu input-append">
									<input placeholder="URL" type="text" data-edit="createLink" />
									<button class="btn" type="button">Add</button>
								</div>
							</div>
							<div class="btn-group">
								<a class="btn btn-default" data-edit="undo" title="Undo (Ctrl/Cmd+Z)"><i class="fas fa-undo"></i></a>
								<a class="btn btn-default" data-edit="redo" title="Redo (Ctrl/Cmd+Y)"><i class="fas fa-repeat"></i></a>
								<a class="btn btn-default" data-edit="html" title="Clear Formatting"><i class='glyphicon glyphicon-pencil'></i></a>
							</div>
						</div> 
						<input type="hidden" id="journal_body" th:field="*{body}"/>
						<div id="editor" class="form-control" data-placeholder="Start your journal..."></div>
					</div>
					<div class="form-group">
						<label for="description">Summary</label>
						<input class="form-control" th:field="*{description}" size="50" type="text" placeholder="Short summary of your journal..."/>
					</div>
				</div>
				<div class="journal-options col-xs-12 col-md-4" th:include="common/fragments_forms :: post_options (${journal}, ${ {:} }, true, true, false, true)">
					journal-options
				</div>
			</div>
		</div>
		<div class="modal-footer">
			<button id="journal-update-btn" type="submit" name="submit" value="Post Now">Update Now</button>
  			
			<button class="btn btn-success" type="button" name="submit" value="Post Now"
				onclick="$('#journal_body').val($('#editor').cleanHtml(true));$('#journal-update-btn').click();">Update Now</button>
  			<button class="btn" type="button" data-dismiss="modal">Cancel</button>
		</div>
		</form>
		<script>
		function checkifcolumn()
		{
			var pollComboBox = document.getElementById("related_poll");
			var dateComboBox = document.getElementById("publish_date");
			var jtypeComboBox = document.getElementById("journal_type");
			
			if (document.forms.editjournal_form.group_id.value==287) {
				pollComboBox.style.display = ""; 
				dateComboBox.style.display = ""; 
				jtypeComboBox.style.display = ""; 
			}
			else {
				pollComboBox.style.display = "none"; 
				dateComboBox.style.display = "none"; 
				jtypeComboBox.style.display = "none"; 
			}
		}
		</script>
	</div>
	<script th:fragment="editJournalForm_JS" th:inline="javascript">
	/*<![CDATA[*/
	var body = /*[[${journal.body}]]*/ "";
	$('#editor').html(body);
	$('#editor').wysiwyg();
	$('#journal-update-btn').hide();
	/*]]>*/
	</script>
	
  
  	<div th:fragment="journal">
		<!-- Blog Post --> 
		
        <!-- Title -->
        <h1 itemprop="name" th:text="${journal.subject}">Blog Post Title</h1>

        <!-- Author -->
        <p class="lead">
            by <a th:if="${journal.author!=null}" th:href='@{|/${journal.author.username}|}' href="#" th:text="${journal.author.username}">Author</a><span th:if="${journal.author==null}">Former Member</span> 
        </p>
        
        <hr/>

        <!-- Date/Time --> 
        <p><span class="glyphicon glyphicon-time"></span> Posted on <time th:datetime="${#temporals.formatISO(journal.datePublished)}" th:text="${#temporals.format(journal.datePublished, #messages.msg('datetime.format.full'))}">August 24, 2013 at 9:00 PM</time></p>

		<!-- Tags -->
  		<div include="common/modules_common :: tags (${journal.uri})">tags</div>
		<!-- Reactions -->
		<div th:include="common/fragments_reactions :: reactions (${journal.reactions}, ${reactionScores}, ${journal.uri}, null)">reactions</div>
        
  		
		<hr sec:authorize="isAuthenticated()" th:if="${#authentication.principal.userId}==${journal.author.userId}" />
		
		<div sec:authorize="isAuthenticated()" th:if="${#authentication.principal.userId}==${journal.author.userId}">
			<!-- Edit -->
			<button data-toggle="modal" data-target="#editJournalModal" class="btn btn-default" type="button" ><i class="glyphicon glyphicon-pencil"></i>&nbsp;Edit Entry</button>
			<!-- Delete -->
			<button data-toggle="modal" data-target="#deleteJournalModal" class="btn btn-danger" type="button" ><i class="glyphicon glyphicon-remove"></i>&nbsp;Delete Entry</button>
		</div>
				
        <hr/>

        <!-- Preview Image -->
        <!-- <img class="img-responsive" src="http://placehold.it/900x300" alt=""/> 

        <hr/>-->

        <!-- Post Content -->
        <div th:utext="${journal.filteredBody}">...HTML Body...</div>
                
        <hr/>
        
        <!-- Tags -->
  		<div include="common/modules_common :: tags (${journal.uri})">tags</div>
				
		<!-- Author Box -->
		<div th:include="profile/fragments_profile :: authorBio (${profile}, ${journal.author})">authorBox</div>

        <!-- Blog Comments -->

        <!-- Comments Form -->
        <div th:replace="common/fragments_comments::post_comment_form(${journal},'Leave a Comment')">Reply Form</div>
        
        <hr/>

        <!-- Posted Comments -->
        <div id="comments" class="comments" th:include="common/fragments_comments :: post_comments (${journal})">Comments</div>
            
	</div>
	
	<div th:fragment="recentPosts (posts)">
		<ul class="list-group">
			<li th:each="recentPost : ${posts}" class="list-group-item">
				<a th:href="@{|${recentPost.uri}|}" href="#" th:text="${recentPost.title}">Cras justo odio</a>
				<small><time th:datetime="${#temporals.formatISO(recentPost.postedOnDate)}" th:text="${#temporals.format(recentPost.postedOnDate, #messages.msg('date.format.full'))}">November 11, 2014</time></small>
			</li>
		</ul>
	</div>
	
  
  </body>
  
 </html>