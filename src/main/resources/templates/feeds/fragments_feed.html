<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity4">

  <body>
  
  	<div th:fragment="newAccountForm_model">
  		<div class="modal-header">
			<button type="button" class="close" data-dismiss="modal"><span>&times;</span></button>
			<h4>Connect Account</h4>
		</div>
		<form th:action="@{|/credentials/new|}" th:object="${newaccount}" method="post"> 
		
		<div class="modal-body">
			
			<div class="form-group">
				<label for="providerId">Account Type</label>
				<select class="form-control" id="providerId" th:field="*{providerId}" th:errorclass="error">
					<option 
						th:each="opt:${accountTypes.entrySet()}"
						th:value="${opt.key}" th:text="${opt.value}">Google</option>
				</select>
				<small class="form-text text-muted">After clicking 'Connect' you will be redirected to that service to authenticate.</small>
			</div>
			
			<div class="form-group" sec:authorize="hasRole('ROLE_ADMIN')" >
				<label for="visibility">Visibility</label>
				<select class="form-control" id="visibility" th:field="*{visibility}" th:errorclass="error">
					<option value="PRIVATE" selected="selected">Private to only you</option>
					<option value="WORLD">World</option>
				</select>
				<small class="form-text text-muted">Will you let others see your public posts from this feed?</small>
			</div>
			<div class="form-group" sec:authorize="!hasRole('ROLE_ADMIN')" >
				<input type="hidden" name="visibility" value="PRIVATE"/>
			</div>
				  		
		</div>
		<div class="modal-footer">
			<button id="connectBtn" class="btn btn-success" type="button" value="Connect">Connect</button>
  			<button class="btn" type="button" data-dismiss="modal">Cancel</button>
		</div>
			
		</form>
  	</div>
  	
  	<script th:fragment="newAccountForm_JS" th:inline="javascript">
  	/*<![CDATA[*/
  		var baseConnectUrl = /*[[@{|/connect/|}]]*/ '/connect/';
  		$('#connectBtn').on('click', function(){
  			var providerId = $('select[name=providerId]').val();
  			
  			var form = $(this).parents('form');
  			form.attr('action', baseConnectUrl+providerId);
  			app.removeBundleFromStorage();
  			form.submit();
  		});
  	/*]]>*/
  	</script>
  	
  	
  	<div th:fragment="deleteAccountForm_model">
		<div class="modal-header">
			<button type="button" class="close" data-dismiss="modal"><span>&times;</span></button>
			<h4>Delete Feed</h4>
		</div>
		<form id="deleteAccount_form" th:action="@{|/feed/${chapter.series.id}/chapter/${chapter.id}/delete|}" th:object="${chapter}" method="post">
		<div class="modal-body">
			Are you sure you want to delete:
			
			<h4 th:text="${chapter.title}">title</h4>
			<small>created on <span th:text="${chapter.dateCreated}">date</span></small>
	
		</div>
		<div class="modal-footer">
			<button class="btn btn-danger" type="submit" name="confirm">Yes, Delete Now</button>
  			<button class="btn" type="button" data-dismiss="modal">Cancel</button>
		</div>
		</form>
		
	</div>
  
  
  </body>
  
 </html>